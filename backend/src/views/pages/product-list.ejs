<%- include('../partials/header') %>

<div class="container py-4">

  <!-- HERO BANNER CH√çNH -->
  <section class="mb-4">
    <div
      class="row align-items-center g-3 rounded-4 p-4 p-md-5"
      style="
        background: linear-gradient(135deg, #e0f2fe, #bfdbfe, #d8b4fe);
        box-shadow: 0 18px 35px rgba(15,23,42,0.18);
      "
    >
      <div class="col-md-7">
        <h1 class="h3 h-md-2 fw-bold mb-3" style="color: #0f172a;">
          N√¢ng c·∫•p g√≥c l√†m vi·ªác c·ªßa b·∫°n
        </h1>
        <p class="mb-3 text-muted">
          Laptop, PC, m√†n h√¨nh, linh ki·ªán ch√≠nh h√£ng ‚Äì giao nhanh, b·∫£o h√†nh uy t√≠n.
          Kh√°m ph√° ∆∞u ƒë√£i ƒë·∫∑c bi·ªát trong tu·∫ßn n√†y c√πng c√°c th∆∞∆°ng hi·ªáu l·ªõn.
        </p>
        <div class="d-flex flex-wrap gap-2 mb-3">
          <a href="/products?special=new" class="btn btn-primary">
            üî• Xem s·∫£n ph·∫©m m·ªõi
          </a>
          <a href="/products?special=best" class="btn btn-outline-primary">
            ‚≠ê S·∫£n ph·∫©m b√°n ch·∫°y
          </a>
        </div>
        <div class="d-flex flex-wrap gap-3 align-items-center">
          <div class="small text-muted">
            <i class="bi bi-truck"></i> Giao h√†ng to√†n qu·ªëc
          </div>
          <div class="small text-muted">
            <i class="bi bi-shield-check"></i> B·∫£o h√†nh ch√≠nh h√£ng
          </div>
          <div class="small text-muted">
            <i class="bi bi-credit-card"></i> Tr·∫£ g√≥p 0% l√£i su·∫•t
          </div>
        </div>
      </div>

      <div class="col-md-5 text-center">
        <img
          src="/images/banner.jpg"
          alt="Khuy·∫øn m√£i m√°y t√≠nh"
          class="img-fluid rounded-3 shadow-sm"
          style="max-height: 260px; object-fit: cover;"
        >
      </div>
    </div>
  </section>

  <!-- D·∫¢I TH∆Ø∆†NG HI·ªÜU / LOGO ƒê·ªêI T√ÅC -->
  <section class="mb-4">
    <div class="card border-0 shadow-sm">
      <div class="card-body py-3">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
          <span class="fw-semibold text-muted">
            ƒê·ªëi t√°c & Th∆∞∆°ng hi·ªáu:
          </span>
          <div class="d-flex flex-wrap gap-3 align-items-center">
            <img src="/images/lenovo.jpeg"    alt="Lenovo"   style="height: 28px; object-fit: contain;">
            <img src="/images/Dell27inch.jpg" alt="Dell"     style="height: 28px; object-fit: contain;">
            <img src="/images/samsung.jpeg"   alt="Samsung"  style="height: 28px; object-fit: contain;">
            <img src="/images/logitech.jpeg"  alt="Logitech" style="height: 28px; object-fit: contain;">
            <img src="/images/intelcorei9.jpg" alt="Intel"   style="height: 28px; object-fit: contain;">
            <img src="/images/nvidia RTX5090.jpg" alt="NVIDIA" style="height: 28px; object-fit: contain;">
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- H√ÄNG BANNER NH·ªé / QU·∫¢NG C√ÅO THEO DANH M·ª§C -->
  <section class="mb-4">
    <div class="row g-3">
      <div class="col-md-4">
        <a href="/products?category=laptop" class="text-decoration-none">
          <div
            class="card border-0 h-100"
            style="background: linear-gradient(135deg, #dbeafe, #eff6ff);"
          >
            <div class="card-body d-flex align-items-center">
              <div>
                <h6 class="fw-bold mb-1 text-primary">Laptop vƒÉn ph√≤ng & gaming</h6>
                <p class="small text-muted mb-0">
                  ∆Øu ƒë√£i ƒë·∫øn 15% cho c√°c d√≤ng laptop Dell, Asus, Lenovo.
                </p>
              </div>
              <img
                src="/images/acer1.jpg"
                alt="Laptop"
                class="ms-auto d-none d-md-block"
                style="height: 60px; object-fit: contain;"
              >
            </div>
          </div>
        </a>
      </div>

      <div class="col-md-4">
        <a href="/products?category=monitor" class="text-decoration-none">
          <div
            class="card border-0 h-100"
            style="background: linear-gradient(135deg, #e0f2fe, #f5f3ff);"
          >
            <div class="card-body d-flex align-items-center">
              <div>
                <h6 class="fw-bold mb-1" style="color:#2563eb;">M√†n h√¨nh si√™u r·ªông & 2K/4K</h6>
                <p class="small text-muted mb-0">
                  N√¢ng c·∫•p g√≥c l√†m vi·ªác v·ªõi m√†n h√¨nh LG, Dell, Samsung.
                </p>
              </div>
              <img
                src="/images/Dell27inch2.jpg"
                alt="Monitor"
                class="ms-auto d-none d-md-block"
                style="height: 60px; object-fit: contain;"
              >
            </div>
          </div>
        </a>
      </div>

      <div class="col-md-4">
        <a href="/products?category=hdd" class="text-decoration-none">
          <div
            class="card border-0 h-100"
            style="background: linear-gradient(135deg, #ecfeff, #e0f2fe);"
          >
            <div class="card-body d-flex align-items-center">
              <div>
                <h6 class="fw-bold mb-1" style="color:#0ea5e9;">·ªî c·ª©ng & linh ki·ªán</h6>
                <p class="small text-muted mb-0">
                  SSD, HDD, RAM, ngu·ªìn, card m√†n h√¨nh ‚Äì build PC theo √Ω b·∫°n.
                </p>
              </div>
              <img
                src="/images/ocungsamsung.jpg"
                alt="·ªî c·ª©ng"
                class="ms-auto d-none d-md-block"
                style="height: 60px; object-fit: contain;"
              >
            </div>
          </div>
        </a>
      </div>
    </div>
  </section>

  <!-- Thanh ti√™u ƒë·ªÅ + m√¥ t·∫£ danh s√°ch -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <div>
      <h2 class="h4 mb-1 text-primary fw-bold">
        üõí Danh s√°ch s·∫£n ph·∫©m
      </h2>
      <p class="text-muted mb-0">
        T√¨m ki·∫øm, l·ªçc v√† s·∫Øp x·∫øp c√°c s·∫£n ph·∫©m trong c·ª≠a h√†ng.
      </p>
    </div>
  </div>

  <!-- Kh·ªëi l·ªçc s·∫£n ph·∫©m -->
  <div class="card shadow-sm mb-4 border-0">
    <div class="card-body">
      <form class="row g-2" method="get" action="/products">
        <div class="col-md-3">
          <label class="form-label small text-muted mb-1">T·ª´ kh√≥a</label>
          <input
            type="text"
            name="q"
            class="form-control"
            placeholder="T√¨m ki·∫øm theo t√™n s·∫£n ph·∫©m..."
            value="<%= query.q || '' %>"
          >
        </div>

        <div class="col-md-2">
          <label class="form-label small text-muted mb-1">Danh m·ª•c</label>
          <select name="category" class="form-select">
            <option value="">T·∫•t c·∫£ danh m·ª•c</option>
            <option value="laptop"  <%= query.category==='laptop'  ? 'selected' : '' %>>Laptop</option>
            <option value="monitor" <%= query.category==='monitor' ? 'selected' : '' %>>M√†n h√¨nh</option>
            <option value="hdd"     <%= query.category==='hdd'     ? 'selected' : '' %>>·ªî c·ª©ng</option>
            <option value="pc"      <%= query.category==='pc'      ? 'selected' : '' %>>PC</option>
          </select>
        </div>

        <div class="col-md-2">
          <label class="form-label small text-muted mb-1">Th∆∞∆°ng hi·ªáu</label>
          <input
            type="text"
            name="brand"
            class="form-control"
            placeholder="VD: Dell, Asus..."
            value="<%= query.brand || '' %>"
          >
        </div>

        <div class="col-md-2">
          <label class="form-label small text-muted mb-1">Lo·∫°i s·∫£n ph·∫©m</label>
          <select name="special" class="form-select">
            <option value="">T·∫•t c·∫£</option>
            <option value="new"  <%= query.special === 'new'  ? 'selected' : '' %>>S·∫£n ph·∫©m m·ªõi</option>
            <option value="best" <%= query.special === 'best' ? 'selected' : '' %>>B√°n ch·∫°y nh·∫•t</option>
          </select>
        </div>

        <div class="col-md-1">
          <label class="form-label small text-muted mb-1">Gi√° min</label>
          <input
            type="number"
            name="price_min"
            class="form-control"
            placeholder="Min"
            value="<%= query.price_min || '' %>"
          >
        </div>

        <div class="col-md-1">
          <label class="form-label small text-muted mb-1">Gi√° max</label>
          <input
            type="number"
            name="price_max"
            class="form-control"
            placeholder="Max"
            value="<%= query.price_max || '' %>"
          >
        </div>

        <div class="col-md-3 mt-2">
          <label class="form-label small text-muted mb-1">S·∫Øp x·∫øp</label>
          <select name="sort" class="form-select">
            <option value="">M·∫∑c ƒë·ªãnh</option>
            <option value="name_asc"    <%= query.sort==='name_asc'    ? 'selected' : '' %>>T√™n A‚ÄìZ</option>
            <option value="name_desc"   <%= query.sort==='name_desc'   ? 'selected' : '' %>>T√™n Z‚ÄìA</option>
            <option value="price_asc"   <%= query.sort==='price_asc'   ? 'selected' : '' %>>Gi√° tƒÉng d·∫ßn</option>
            <option value="price_desc"  <%= query.sort==='price_desc'  ? 'selected' : '' %>>Gi√° gi·∫£m d·∫ßn</option>
            <option value="rating_asc"  <%= query.sort==='rating_asc'  ? 'selected' : '' %>>X·∫øp h·∫°ng th·∫•p ‚Üí cao</option>
            <option value="rating_desc" <%= query.sort==='rating_desc' ? 'selected' : '' %>>X·∫øp h·∫°ng cao ‚Üí th·∫•p</option>
          </select>
        </div>

        <div class="col-md-2 mt-4 d-flex align-items-end">
          <button class="btn btn-primary w-100 me-2">
            L·ªçc
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Danh s√°ch s·∫£n ph·∫©m -->
  <% if (!items || items.length === 0) { %>
    <div class="alert alert-warning">
      Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m ph√π h·ª£p v·ªõi b·ªô l·ªçc hi·ªán t·∫°i.
    </div>
  <% } else { %>
    <div class="row g-3">
      <% items.forEach(product => { %>
        <div class="col-6 col-md-4 col-lg-3">
          <div class="card h-100 border-0 shadow-sm product-card">

            <!-- ·∫¢nh + badge -->
            <div class="position-relative">
              <a href="/product/<%= product._id %>">
                <img
                  src="<%= product.images && product.images[0] ? product.images[0] : '/images/placeholder.jpg' %>"
                  class="card-img-top p-3"
                  alt="<%= product.name %>"
                  style="height: 200px; object-fit: contain;"
                >
              </a>

              <% if (product.isNew) { %>
                <span class="badge bg-success position-absolute top-0 start-0 m-2">
                  M·ªõi
                </span>
              <% } %>

              <% if (product.isBestSeller) { %>
                <span class="badge bg-warning text-dark position-absolute top-0 end-0 m-2">
                  B√°n ch·∫°y
                </span>
              <% } %>
            </div>

            <!-- N·ªôi dung card -->
            <div class="card-body d-flex flex-column">
              <h6 class="card-title mb-1 text-truncate" title="<%= product.name %>">
                <%= product.name %>
              </h6>

              <div class="mb-1">
                <span class="badge bg-light text-muted border me-1">
                  <i class="bi bi-tag"></i> <%= product.brand || 'Kh√¥ng r√µ h√£ng' %>
                </span>
                <span class="badge bg-light text-muted border">
                  <i class="bi bi-grid"></i> <%= product.category || 'Kh√°c' %>
                </span>
              </div>

              <p class="card-text text-danger fw-bold mb-2">
                <%= product.price.toLocaleString('vi-VN') %> ‚Ç´
              </p>

              <!-- Rating -->
              <div class="mb-2">
                <% if (product.numRatings && product.numRatings > 0) { %>
                  <% const fullStars = Math.round(product.averageRating || 0); %>
                  <% for (let i = 1; i <= 5; i++) { %>
                    <% if (i <= fullStars) { %>
                      <span class="text-warning">‚òÖ</span>
                    <% } else { %>
                      <span class="text-muted">‚òÖ</span>
                    <% } %>
                  <% } %>
                  <small class="text-muted ms-1">
                    (<%= product.numRatings %> ƒë√°nh gi√°)
                  </small>
                <% } else { %>
                  <small class="text-muted">Ch∆∞a c√≥ ƒë√°nh gi√°</small>
                <% } %>
              </div>

              <!-- N√∫t th√™m v√†o gi·ªè -->
              <form method="post" action="/cart/add" class="mt-auto">
                <input type="hidden" name="productId" value="<%= product._id %>">
                <input type="hidden" name="quantity" value="1">
                <button class="btn btn-sm btn-primary w-100">
                  Th√™m v√†o gi·ªè
                </button>
              </form>
            </div>
          </div>
        </div>
      <% }) %>
    </div>
  <% } %>

  <!-- Ph√¢n trang -->
  <% if (totalPages && totalPages > 1) { %>
    <nav class="mt-4 d-flex justify-content-center">
      <ul class="pagination pagination-sm">
        <% for (let i = 1; i <= totalPages; i++) { %>
          <li class="page-item <%= i === currentPage ? 'active' : '' %>">
            <a
              class="page-link"
              href="?<%= Object.entries(query)
                    .filter(([k]) => k !== 'page' && query[k])
                    .map(([k, v]) => k + '=' + encodeURIComponent(v))
                    .join('&') %><%= Object.keys(query).length ? '&' : '' %>page=<%= i %>">
              <%= i %>
            </a>
          </li>
        <% } %>
      </ul>
    </nav>
  <% } %>

</div>
  <!-- BANNER CU·ªêI TRANG ‚Äì CALL TO ACTION -->
  <section class="mt-5 mb-4">
    <div
      class="row g-3 align-items-center rounded-4 p-4 p-md-5"
      style="
        background: radial-gradient(circle at top left, #e0f2fe 0, #bfdbfe 40%, #c4b5fd 100%);
        box-shadow: 0 16px 32px rgba(15,23,42,0.16);
      "
    >
      <div class="col-md-8">
        <h2 class="h4 h-md-3 fw-bold mb-2" style="color:#0f172a;">
          C·∫ßn t∆∞ v·∫•n c·∫•u h√¨nh ho·∫∑c ch·ªçn s·∫£n ph·∫©m ph√π h·ª£p?
        </h2>
        <p class="mb-3 text-muted">
          ƒê·ªôi ng≈© k·ªπ thu·∫≠t lu√¥n s·∫µn s√†ng h·ªó tr·ª£ b·∫°n build PC, ch·ªçn laptop, m√†n h√¨nh, linh ki·ªán
          ph√π h·ª£p v·ªõi ng√¢n s√°ch v√† nhu c·∫ßu h·ªçc t·∫≠p ‚Äì l√†m vi·ªác ‚Äì gi·∫£i tr√≠.
        </p>

        <div class="d-flex flex-wrap gap-2 mb-3">
          <a href="/products?special=best" class="btn btn-primary">
            üî• Xem khuy·∫øn m√£i & s·∫£n ph·∫©m hot
          </a>
          <a href="/contact" class="btn btn-outline-primary">
            üí¨ Li√™n h·ªá t∆∞ v·∫•n mi·ªÖn ph√≠
          </a>
        </div>

        <div class="d-flex flex-wrap gap-3 small text-muted">
          <span><i class="bi bi-telephone"></i> Hotline: <strong>1900 1234</strong> (8:00 ‚Äì 21:00)</span>
          <span><i class="bi bi-geo-alt"></i> Showroom: Qu·∫≠n 1, TP. H·ªì Ch√≠ Minh</span>
          <span><i class="bi bi-envelope"></i> Email: support@ecommerce.com</span>
        </div>
      </div>

      <div class="col-md-4 text-center">
        <div
          class="rounded-4 p-3 p-md-4 h-100 d-flex flex-column justify-content-center"
          style="background: linear-gradient(135deg, rgba(59,130,246,0.1), rgba(79,70,229,0.18));"
        >
          <p class="small text-uppercase text-muted mb-1">∆Øu ƒë√£i th√†nh vi√™n</p>
          <h3 class="h5 fw-bold mb-2" style="color:#1d4ed8;">
            Gi·∫£m th√™m 5% cho ƒë∆°n h√†ng ƒë·∫ßu ti√™n
          </h3>
          <p class="small text-muted mb-3">
            ƒêƒÉng nh·∫≠p ho·∫∑c t·∫°o t√†i kho·∫£n ƒë·ªÉ t√≠ch ƒëi·ªÉm, nh·∫≠n voucher v√† theo d√µi ƒë∆°n h√†ng d·ªÖ d√†ng.
          </p>
          <a href="/login" class="btn btn-sm btn-primary w-100 mb-2">
            ƒêƒÉng nh·∫≠p / ƒêƒÉng k√Ω ngay
          </a>
          <p class="text-muted small mb-0">
            <i class="bi bi-shield-check"></i> B·∫£o m·∫≠t t√†i kho·∫£n & th√¥ng tin thanh to√°n.
          </p>
        </div>
      </div>
    </div>
  </section>

<%- include('../partials/footer') %>
